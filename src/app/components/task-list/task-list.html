<div class="container">
  <!-- Header -->
  <header>
    <h1>ğŸ“ Mes TÃ¢ches</h1>
    <div class="user-info">
      <span *ngIf="currentUser$ | async as user">ğŸ‘¤ {{ user }}</span>
      <button class="btn-logout" (click)="onLogout()">DÃ©connexion</button>
    </div>
  </header>

  <!-- Add Task Button -->
  <div class="actions">
    <button class="btn-add" (click)="toggleForm()">
      {{ showForm ? 'âŒ Annuler' : 'â• Nouvelle tÃ¢che' }}
    </button>
  </div>

  <!-- Task Form -->
  <div class="form-container" *ngIf="showForm">
    <h2>{{ editingTask ? 'âœï¸ Modifier la tÃ¢che' : 'â• Nouvelle tÃ¢che' }}</h2>
    
    <form [formGroup]="taskForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label>Titre *</label>
        <input 
          type="text" 
          formControlName="title"
          placeholder="Titre de la tÃ¢che"
          [class.error]="f['title'].invalid && f['title'].touched"
        />
        <div class="error-message" *ngIf="f['title'].invalid && f['title'].touched">
          <small *ngIf="f['title'].errors?.['required']">Le titre est requis</small>
          <small *ngIf="f['title'].errors?.['maxlength']">Max 100 caractÃ¨res</small>
        </div>
      </div>

      <div class="form-group">
        <label>Description</label>
        <textarea 
          formControlName="description"
          placeholder="Description de la tÃ¢che"
          rows="3"
        ></textarea>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>PrioritÃ© * (1-5)</label>
          <select formControlName="priority">
            <option value="1">1 - TrÃ¨s basse</option>
            <option value="2">2 - Basse</option>
            <option value="3">3 - Moyenne</option>
            <option value="4">4 - Haute</option>
            <option value="5">5 - Urgente</option>
          </select>
        </div>

        <div class="form-group">
          <label>Date d'Ã©chÃ©ance *</label>
          <input 
            type="date" 
            formControlName="dueDate"
            [class.error]="f['dueDate'].invalid && f['dueDate'].touched"
          />
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-primary" [disabled]="taskForm.invalid">
          {{ editingTask ? 'ğŸ’¾ Sauvegarder' : 'â• Ajouter' }}
        </button>
        <button type="button" class="btn-secondary" (click)="toggleForm()">
          Annuler
        </button>
      </div>
    </form>
  </div>

  <!-- Active Tasks -->
  <section class="tasks-section">
    <h2>ğŸ”¥ TÃ¢ches en cours</h2>
    
    <div *ngIf="activeTasks$ | async as tasks">
      <div *ngIf="tasks.length === 0" class="empty-state">
        <p>âœ… Aucune tÃ¢che en cours</p>
      </div>
      
      <div class="task-grid">
        <div *ngFor="let task of tasks" class="task-card">
          <div class="task-header">
            <h3>{{ task.title }}</h3>
            <span class="priority-badge" [ngClass]="getPriorityClass(task.priority)">
              {{ getPriorityLabel(task.priority) }}
            </span>
          </div>
          
          <p class="task-description">{{ task.description || 'Aucune description' }}</p>
          
          <div class="task-footer">
            <span class="due-date">ğŸ“… {{ task.dueDate | date:'dd/MM/yyyy' }}</span>
            
            <div class="task-actions">
              <button class="btn-icon btn-complete" (click)="onToggle(task.id)" title="Marquer comme terminÃ©e">
                âœ“
              </button>
              <button class="btn-icon btn-edit" (click)="onEdit(task)" title="Modifier">
                âœï¸
              </button>
              <button class="btn-icon btn-delete" (click)="onDelete(task.id)" title="Supprimer">
                ğŸ—‘ï¸
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Completed Tasks -->
  <section class="tasks-section">
    <h2>âœ… TÃ¢ches terminÃ©es</h2>
    
    <div *ngIf="completedTasks$ | async as tasks">
      <div *ngIf="tasks.length === 0" class="empty-state">
        <p>Aucune tÃ¢che terminÃ©e</p>
      </div>
      
      <div class="task-grid">
        <div *ngFor="let task of tasks" class="task-card completed">
          <div class="task-header">
            <h3>{{ task.title }}</h3>
            <span class="priority-badge" [ngClass]="getPriorityClass(task.priority)">
              {{ getPriorityLabel(task.priority) }}
            </span>
          </div>
          
          <p class="task-description">{{ task.description || 'Aucune description' }}</p>
          
          <div class="task-footer">
            <span class="due-date">ğŸ“… {{ task.dueDate | date:'dd/MM/yyyy' }}</span>
            
            <div class="task-actions">
              <button class="btn-icon btn-uncomplete" (click)="onToggle(task.id)" title="RÃ©activer">
                â†©ï¸
              </button>
              <button class="btn-icon btn-delete" (click)="onDelete(task.id)" title="Supprimer">
                ğŸ—‘ï¸
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>